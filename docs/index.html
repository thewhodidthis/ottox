<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>index.es</title>
    <link rel="stylesheet" media="all" href="docco.css" />
  </head>

  <body>
    <div class="background"></div>

    

    <div class="sections">
      <ul>

        
        <li class="section">
          <div class="annotation">
            <h1 class="title">index.es</h1>
          </div>
        </li>
          

        
        
        <li id="section-1" class="section">
          <div class="annotation">
            
            <div class="pilwrap">
              <a class="pilcrow" href="#section-1">&#182;</a>
            </div>
            
          </div>

          
          <div class="content"><div class='highlight'><pre><span class="hljs-keyword">const</span> Otto = <span class="hljs-function">(<span class="hljs-params">{ span = <span class="hljs-number">1</span>, size = <span class="hljs-number">0</span>, rule = <span class="hljs-number">90</span> } = {}</span>) =&gt;</span> {</pre></div></div>
          
        </li>
        
        
        <li id="section-2" class="section">
          <div class="annotation">
            
            <div class="pilwrap">
              <a class="pilcrow" href="#section-2">&#182;</a>
            </div>
            <p>Cells</p>

          </div>

          
          <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">const</span> grid = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(size);</pre></div></div>
          
        </li>
        
        
        <li id="section-3" class="section">
          <div class="annotation">
            
            <div class="pilwrap">
              <a class="pilcrow" href="#section-3">&#182;</a>
            </div>
            <p>Lookup table</p>

          </div>

          
          <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">const</span> ruleset = rule.toString(<span class="hljs-number">2</span>).split(<span class="hljs-string">''</span>).reverse();</pre></div></div>
          
        </li>
        
        
        <li id="section-4" class="section">
          <div class="annotation">
            
            <div class="pilwrap">
              <a class="pilcrow" href="#section-4">&#182;</a>
            </div>
            <p>Wrap index round edges
<a href="http://stackoverflow.com/questions/1082917/mod-of-negative-number-is-melting-my-brain/1082938#1082938">http://stackoverflow.com/questions/1082917/mod-of-negative-number-is-melting-my-brain/1082938#1082938</a></p>

          </div>

          
          <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">const</span> getIndex = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - (b * <span class="hljs-built_in">Math</span>.floor(a / b));</pre></div></div>
          
        </li>
        
        
        <li id="section-5" class="section">
          <div class="annotation">
            
            <div class="pilwrap">
              <a class="pilcrow" href="#section-5">&#182;</a>
            </div>
            <p>Calculate state</p>

          </div>

          
          <div class="content"><div class='highlight'><pre>  <span class="hljs-keyword">const</span> getState = <span class="hljs-function">(<span class="hljs-params">v, i, arr</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> state = [];</pre></div></div>
          
        </li>
        
        
        <li id="section-6" class="section">
          <div class="annotation">
            
            <div class="pilwrap">
              <a class="pilcrow" href="#section-6">&#182;</a>
            </div>
            <p>The neighborhood</p>

          </div>

          
          <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = -span; j &lt;= span; j += <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">const</span> x = getIndex(i + j, arr.length);
      <span class="hljs-keyword">const</span> n = arr[x] || <span class="hljs-number">0</span>;

      state.push(n);
    }

    <span class="hljs-keyword">return</span> ruleset[<span class="hljs-built_in">parseInt</span>(state.join(<span class="hljs-string">''</span>), <span class="hljs-number">2</span>)];
  };</pre></div></div>
          
        </li>
        
        
        <li id="section-7" class="section">
          <div class="annotation">
            
            <div class="pilwrap">
              <a class="pilcrow" href="#section-7">&#182;</a>
            </div>
            <p>Flip cell in the middle</p>

          </div>

          
          <div class="content"><div class='highlight'><pre>  grid[<span class="hljs-built_in">Math</span>.floor(size * <span class="hljs-number">0.5</span>)] = <span class="hljs-number">1</span>;

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">next</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> grid.set(grid.map(getState)),
    <span class="hljs-attr">grid</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> grid,
  };
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Otto;</pre></div></div>
          
        </li>
        

      </ul>
    </div>
  </body>
</html>
